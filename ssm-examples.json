{
  "description": "Example SSM Parameter Store configuration for Ephemeral VPN",
  "ssm_prefix": "/ephem-vpn",
  "parameters": {
    "/ephem-vpn/api-key": {
      "type": "SecureString",
      "description": "API key for authenticating requests to the VPN management API",
      "generated_by": "entrypoint.sh (auto-generated if not exists)",
      "example_value": "a1b2c3d4e5f678901234567890abcdef1234567890abcdef1234567890abcdef"
    },
    "/ephem-vpn/server.conf": {
      "type": "SecureString",
      "description": "OpenVPN server configuration file content",
      "generated_by": "entrypoint.sh (default config if not exists)",
      "example_value": "port 1194\nproto udp\ndev tun\nca /etc/openvpn/easy-rsa/pki/ca.crt\ncert /etc/openvpn/easy-rsa/pki/issued/server.crt\nkey /etc/openvpn/easy-rsa/pki/private/server.key\ndh /etc/openvpn/easy-rsa/pki/dh.pem\ntls-auth ta.key 0\nserver 10.8.0.0 255.255.255.0\nifconfig-pool-persist ipp.txt\npush \"redirect-gateway def1 bypass-dhcp\"\npush \"dhcp-option DNS 8.8.8.8\"\npush \"dhcp-option DNS 8.8.4.4\"\nkeepalive 10 120\ncipher AES-256-GCM\nauth SHA256\nuser nobody\ngroup nobody\npersist-key\npersist-tun\nstatus openvpn-status.log\nverb 3\ncrl-verify /etc/openvpn/easy-rsa/pki/crl.pem\nclient-config-dir /etc/openvpn/ccd"
    },
    "/ephem-vpn/clients/{client_id}": {
      "type": "SecureString",
      "description": "Individual client OpenVPN configuration files",
      "generated_by": "API POST /clients endpoint",
      "example_value": "client\ndev tun\nproto udp\nremote vpn.example.com 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nremote-cert-tls server\ncipher AES-256-GCM\nauth SHA256\nkey-direction 1\nverb 3\n\n<ca>\n-----BEGIN CERTIFICATE-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END CERTIFICATE-----\n</ca>\n\n<cert>\n-----BEGIN CERTIFICATE-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END CERTIFICATE-----\n</cert>\n\n<key>\n-----BEGIN PRIVATE KEY-----\nMIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQg...\n-----END PRIVATE KEY-----\n</key>\n\n<tls-auth>\n#\n# 2048 bit OpenVPN static key\n#\n-----BEGIN OpenVPN Static key V1-----\n...\n-----END OpenVPN Static key V1-----\n</tls-auth>"
    },
    "/ephem-vpn/pki/ca.key": {
      "type": "SecureString",
      "description": "CA private key for certificate signing",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN PRIVATE KEY-----\nMIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQg...\n-----END PRIVATE KEY-----"
    },
    "/ephem-vpn/pki/ca.crt": {
      "type": "SecureString",
      "description": "CA certificate for client/server verification",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN CERTIFICATE-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END CERTIFICATE-----"
    },
    "/ephem-vpn/pki/dh.pem": {
      "type": "SecureString",
      "description": "Diffie-Hellman parameters for key exchange",
      "generated_by": "entrypoint.sh (auto-generated on first run, takes several minutes)",
      "example_value": "-----BEGIN DH PARAMETERS-----\nMIIBCAKCAQEA...\n-----END DH PARAMETERS-----"
    },
    "/ephem-vpn/pki/ta.key": {
      "type": "SecureString",
      "description": "TLS authentication key for additional security",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN OpenVPN Static key V1-----\n...\n-----END OpenVPN Static key V1-----"
    },
    "/ephem-vpn/pki/server.key": {
      "type": "SecureString",
      "description": "Server private key",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN PRIVATE KEY-----\nMIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQg...\n-----END PRIVATE KEY-----"
    },
    "/ephem-vpn/pki/server.crt": {
      "type": "SecureString",
      "description": "Server certificate",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN CERTIFICATE-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END CERTIFICATE-----"
    },
    "/ephem-vpn/pki/crl.pem": {
      "type": "SecureString",
      "description": "Certificate Revocation List",
      "generated_by": "entrypoint.sh (auto-generated on first run)",
      "example_value": "-----BEGIN X509 CRL-----\nMIIB...\n-----END X509 CRL-----"
    }
  },
  "file_mappings": {
    "container_paths": {
      "/etc/openvpn/server.conf": "Content from /ephem-vpn/server.conf",
      "/etc/openvpn/easy-rsa/pki/ca.crt": "Generated by easy-rsa during PKI init",
      "/etc/openvpn/easy-rsa/pki/issued/server.crt": "Generated by easy-rsa during server setup",
      "/etc/openvpn/easy-rsa/pki/private/server.key": "Generated by easy-rsa during server setup",
      "/etc/openvpn/easy-rsa/pki/dh.pem": "Generated by easy-rsa during PKI init",
      "/etc/openvpn/ta.key": "Generated by openvpn during PKI init",
      "/etc/openvpn/easy-rsa/pki/crl.pem": "Generated by easy-rsa when CRL is created/updated",
      "/etc/openvpn/clients/{client_id}.ovpn": "Content from /ephem-vpn/clients/{client_id}"
    }
  },
  "environment_variables": {
    "SSM_PREFIX": {
      "default": "/ephem-vpn",
      "description": "Prefix for all SSM parameters"
    },
    "AWS_REGION": {
      "default": "us-east-1",
      "description": "AWS region for SSM and other AWS services"
    },
    "API_PORT": {
      "default": "8000",
      "description": "Port for the Python FastAPI server"
    },
    "VPN_PORT": {
      "default": "1194",
      "description": "Port for OpenVPN server"
    },
    "VPN_PROTO": {
      "default": "udp",
      "description": "Protocol for OpenVPN (udp/tcp)"
    }
  },
  "iam_policy": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": [
          "ssm:GetParameter",
          "ssm:PutParameter",
          "ssm:DescribeParameters",
          "ssm:DeleteParameter"
        ],
        "Resource": [
          "arn:aws:ssm:*:*:parameter/ephem-vpn/*"
        ]
      }
    ]
  }
}
